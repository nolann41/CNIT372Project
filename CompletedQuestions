/* Question: From which countries do the most popular and successful channels originate? */
/* COMPLETED BY: NATE */

CREATE OR REPLACE PROCEDURE GetTop100ChannelsWithCountries
AS
BEGIN
    -- Use a cursor to fetch the top 100 channels
    FOR channel_row IN (
        SELECT channel_title, country
        FROM GLOBAL_YT_STATS
        ORDER BY rank
        FETCH FIRST 100 ROWS ONLY
    ) 
    LOOP
        DBMS_OUTPUT.PUT_LINE('Channel Name: ' || channel_row.channel_title || ', Country: ' || channel_row.country);
    END LOOP;
END;


/* GetTop100ChannelsWithCountries Query Results
Channel Name: T-Series, Country: India
Channel Name: youtubemovies, Country: United States
Channel Name: MrBeast, Country: United States
Channel Name: Cocomelon - Nursery Rhymes, Country: United States
Channel Name: SET India, Country: India
Channel Name: Music, Country: 
Channel Name: ýýý Kids Diana Show, Country: United States
Channel Name: PewDiePie, Country: Japan
Channel Name: Like Nastya Vlog, Country: Russia
Channel Name: Vlad and Niki, Country: United States
Channel Name: Zee Music Company, Country: India
Channel Name: WWE, Country: United States
Channel Name: Gaming, Country: 
Channel Name: BLACKPINK, Country: South Korea
Channel Name: goldmines, Country: 
Channel Name: Sony SAB, Country: India
Channel Name: 5-Minute Crafts 2.0, Country: United Kingdom
Channel Name: BANGTANTV, Country: South Korea
Channel Name: sports, Country: United States
Channel Name: Justin Bieber, Country: Canada
Channel Name: HYBE LABELS, Country: South Korea
Channel Name: Zee TV, Country: India
Channel Name: Pinkfong Baby Shark - Kids' Songs & Stories, Country: United States
Channel Name: Canal KondZilla, Country: Brazil
Channel Name: ChuChu TV Nursery Rhymes & Kids Songs, Country: India
Channel Name: Shemaroo Filmi Gaane, Country: India
Channel Name: Colors TV, Country: India
Channel Name: T- SERIES BHAKTI SAGAR, Country: India
Channel Name: Dude Perfect, Country: United States
Channel Name: Movieclips, Country: United States
Channel Name: Tips Official, Country: India
Channel Name: El Reino Infantil, Country: Argentina
Channel Name: Wave Music, Country: India
Channel Name: Aaj Tak, Country: India
Channel Name: Sony Music India, Country: India
Channel Name: EminemMusic, Country: United States
Channel Name: Marshmello, Country: United States
Channel Name: YRF, Country: India
Channel Name: LooLoo Kids - Nursery Rhymes and Children's ï¿½, Country: 
Channel Name: Ed Sheeran, Country: United Kingdom
Channel Name: Infobells - Hindi, Country: India
Channel Name: Taylor Swift, Country: United States
Channel Name: Ariana Grande, Country: United States
Channel Name: BillionSurpriseToys  - Nursery Rhymes & Cartï¿½, Country: United States
Channel Name: JuegaGerman, Country: Chile
Channel Name: Billie Eilish, Country: United States
Channel Name: Get Movies, Country: Russia
Channel Name: Shemaroo, Country: India
Channel Name: badabun, Country: 
Channel Name: SonyMusicIndiaVEVO, Country: United States
Channel Name: aefour, Country: Cuba
Channel Name: badbunny, Country: 
Channel Name: Ferfloo, Country: El Salvador
Channel Name: Voot Kids, Country: India
Channel Name: Felipe Neto, Country: Brazil
Channel Name: Vocï¿½ï¿½ï¿½, Country: Brazil
Channel Name: HAR PAL GEO, Country: Pakistan
Channel Name: brightside, Country: 
Channel Name: Katy Perry, Country: United States
Channel Name: whinderssonnunes, Country: Brazil
Channel Name: ABS-CBN Entertainment, Country: Philippines
Channel Name: alanwalker, Country: Thailand
Channel Name: holasoygerman. 2, Country: 
Channel Name: Shakira, Country: Colombia
Channel Name: ARY Digital HD, Country: Pakistan
Channel Name: Speed Records, Country: India
Channel Name: Masha and The Bear, Country: United States
Channel Name: Like Nastya Show, Country: United States
Channel Name: Rihanna, Country: Barbados
Channel Name: Ishtar Music, Country: India
Channel Name: Kimberly Loaiza, Country: Mexico
Channel Name: Little Baby Bum - Nursery Rhymes & Kids Songs, Country: United States
Channel Name: Luis Arturo Villar Sudek, Country: Mexico
Channel Name: elrubiusOMG, Country: 
Channel Name: Toys and colors, Country: 
Channel Name: shfa2 - ï¿½ï¿½, Country: United Arab Emirates
Channel Name: LUCCAS NETO- LUCCAS TOON, Country: 
Channel Name: CarryMinati, Country: India
Channel Name: XXXTENTACION, Country: United States
Channel Name: Super Simple Songs - Kids Songs, Country: Canada
Channel Name: Mikecrack, Country: Spain
Channel Name: WorkpointOfficial, Country: Thailand
Channel Name: GR6 EXPLODE, Country: Brazil
Channel Name: TEDx Talks, Country: United States
Channel Name: ýýýýýýýýýý ýýýýýý, Country: Saudi Arabia
Channel Name: Goldmines Gaane Sune Ansune, Country: India
Channel Name: 21 Savage, Country: United States
Channel Name: TheEllenShow, Country: United States
Channel Name: Sony PAL, Country: India
Channel Name: Daddy Yankee, Country: United States
Channel Name: Vlad vï¿½ï¿½ï, Country: United States
Channel Name: Like Nastya ESP, Country: United States
Channel Name: ýýýýýýýýýýýý one31, Country: Thailand
Channel Name: Jkk Entertainment, Country: India
Channel Name: ABP NEWS, Country: India
Channel Name: Maria Clara & JP, Country: Brazil
Channel Name: Bruno Mars, Country: United States
Channel Name: Maroon 5, Country: United States
Channel Name: Ultra Bollywood, Country: India
Channel Name: PowerKids TV, Country: 
*/

/* Question: Are older channels significantly more successful earnings-wise than newer channels? */
/* COMPLETED BY: NATE */

CREATE OR REPLACE PROCEDURE GetAvgHighestEarningsByCreatedYear
AS
BEGIN
    FOR earnings_row IN (
        SELECT
            EXTRACT(YEAR FROM created_year) AS created_year,
            ROUND(AVG(highest_monthly_earn), 2) AS avg_highest_monthly_earnings,
            ROUND(AVG(highest_yearly_earnings), 2) AS avg_highest_yearly_earnings
        FROM GLOBAL_YT_STATS
        GROUP BY EXTRACT(YEAR FROM created_year)
        ORDER BY created_year
    )
    LOOP
        -- Print or do something with the average earnings data
        DBMS_OUTPUT.PUT_LINE('Year: ' || earnings_row.created_year ||
                             ', Avg Highest Monthly Earnings: ' || earnings_row.avg_highest_monthly_earnings ||
                             ', Avg Highest Yearly Earnings: ' || earnings_row.avg_highest_yearly_earnings);
    END LOOP;
END;


/*GetAvgHighestEarningsByCreatedYear Query Results
Year: 1970,  Avg Highest Monthly Earnings: 84400, Avg Highest Yearly Earnings: 1000000
Year: 2005, Avg Highest Monthly Earnings: 581795.86, Avg Highest Yearly Earnings: 7001296.09
Year: 2006, Avg Highest Monthly Earnings: 676183.31, Avg Highest Yearly Earnings: 8123616.11
Year: 2007, Avg Highest Monthly Earnings: 661672.39, Avg Highest Yearly Earnings: 7968823.94
Year: 2008, Avg Highest Monthly Earnings: 629133.7, Avg Highest Yearly Earnings: 7533093.39
Year: 2009, Avg Highest Monthly Earnings: 508033.34, Avg Highest Yearly Earnings: 6072088.25
Year: 2010, Avg Highest Monthly Earnings: 292182.45, Avg Highest Yearly Earnings: 3518038.38
Year: 2011, Avg Highest Monthly Earnings: 408051.17, Avg Highest Yearly Earnings: 4915421.67
Year: 2012, Avg Highest Monthly Earnings: 526064.85, Avg Highest Yearly Earnings: 6293154.69
Year: 2013, Avg Highest Monthly Earnings: 453838.72, Avg Highest Yearly Earnings: 5419222.77
Year: 2014, Avg Highest Monthly Earnings: 601553.22, Avg Highest Yearly Earnings: 7223349.93
Year: 2015, Avg Highest Monthly Earnings: 469904.28, Avg Highest Yearly Earnings: 5642468.7
Year: 2016, Avg Highest Monthly Earnings: 668412.71, Avg Highest Yearly Earnings: 8051832.27
Year: 2017, Avg Highest Monthly Earnings: 557369.75, Avg Highest Yearly Earnings: 6689161.44
Year: 2018, Avg Highest Monthly Earnings: 507319.96, Avg Highest Yearly Earnings: 6079113.5
Year: 2019, Avg Highest Monthly Earnings: 521242.03, Avg Highest Yearly Earnings: 6270468.88
Year: 2020, Avg Highest Monthly Earnings: 1986075.07, Avg Highest Yearly Earnings: 23844150.02
Year: 2021, Avg Highest Monthly Earnings: 1118292.52, Avg Highest Yearly Earnings: 13430605.32
Year: 2022, Avg Highest Monthly Earnings: 16227.2, Avg Highest Yearly Earnings: 194626.27
Year: , Avg Highest Monthly Earnings: 0, Avg Highest Yearly Earnings: 0


PL/SQL procedure successfully completed.
*/

/* Question: How does overall video uploads affect total? */
/* COMPLETED BY: SEAN */

create or replace procedure lifetime_uploads_views IS

    v_uploadcount GLOBAL_YT_STATS.UPLOAD_COUNT%TYPE; 
    v_videoviews GLOBAL_YT_STATS.VIDEO_VIEWS%TYPE;
    v_channelname GLOBAL_YT_STATS.CHANNEL_TITLE%TYPE;
    v_averageviews GLOBAL_YT_STATS.VIDEO_VIEWS%TYPE;

begin 

FOR channel IN (
        SELECT CHANNEL_TITLE,VIDEO_VIEWS, UPLOAD_COUNT 
        FROM GLOBAL_YT_STATS
    )
    LOOP
        v_channelname := channel.CHANNEL_TITLE;
        v_videoviews := channel.VIDEO_VIEWS; 
        v_uploadcount := channel.UPLOAD_COUNT; 

        IF v_uploadcount > 1 THEN 
            v_averageviews := v_videoviews / v_uploadcount;
        END IF;
        
        v_averageviews := ROUND(v_averageviews, 1);


        IF v_averageviews > 1000000 THEN
            dbms_output.put_line('Channel: ' || v_channelname || '     Average Views: ' || v_averageviews);
        END IF;

    END LOOP;



END lifetime_uploads_views;

/*Query Results

Channel: Toys and colors     Average Views: 11751263289
Channel: wowkidz     Average Views: 8306720739.5
Channel: ToyPudding TV[ï¿½ï¿½ï¿½ï¿½ï     Average Views: 7958441114
Channel: TalkingTom     Average Views: 7599665083
Channel: drake     Average Views: 5106298372.7
Channel: Desi music factory     Average Views: 5094513727.5
Channel: TG MAYANK YT     Average Views: 3881038506
Channel: Claudio     Average Views: 3677597002.3
Channel: salman Noman     Average Views: 3464345967.3
Channel: zuni and family     Average Views: 3373134729
Channel: ali-a     Average Views: 3074151634
Channel: LooLoo Kids - Nursery Rhymes and Children's ï¿½     Average Views: 2937493749
Channel: Extra polinesios     Average Views: 2406563752
Channel: T- SERIES BHAKTI SAGAR     Average Views: 2271786948.3
Channel: Masha y El oso     Average Views: 2262857121
Channel: jamuna tv24     Average Views: 2021597175.8
Channel: Ti Ti     Average Views: 1884312866.3
Channel: TrapCity     Average Views: 1709843282
Channel: alanwalker     Average Views: 1610533097.3
Channel: MrBeastGaming     Average Views: 1266266509.4
Channel: Dorukhan Gï¿½ï¿½ï     Average Views: 1245514602.1
Channel: 21 Savage     Average Views: 1236263983.6
Channel: straykids     Average Views: 1121410162.3
Channel: Michael Jackson     Average Views: 960831641.7
Channel: Adele     Average Views: 946607201.1


PL/SQL procedure successfully completed.
*/

/* Question: How do keywords affect view count? */
/* COMPLETED BY: SEAN */

create or replace PROCEDURE keywords_popular
IS
    CURSOR popularCursor IS 
        SELECT KEYWORD, COUNT(*) AS keywords_CNT
        FROM YT_VIDEO_STATS 
        GROUP BY KEYWORD
        ORDER BY keywords_CNT DESC
        FETCH FIRST 5 ROWS ONLY;

BEGIN

dbms_output.put_line('Popular Keywords:');

FOR popular_keywords IN popularCursor LOOP
        dbms_output.put_line('Keyword: ' || popular_keywords.KEYWORD || '      Number of Occurrences: ' || popular_keywords.keywords_CNT);
    END LOOP;

END;
/*Query Results

Popular Keywords:
Keyword: cubes      Number of Occurrences: 50
Keyword: minecraft      Number of Occurrences: 50
Keyword: asmr      Number of Occurrences: 50
Keyword: data science      Number of Occurrences: 50
Keyword: game development      Number of Occurrences: 50


PL/SQL procedure successfully completed.


*/

/* Question: What is the relationship between recent and legacy success? */
/* COMPLETED BY: Sean */

create or replace procedure recent_legacy_success IS

    v_views30 GLOBAL_YT_STATS.VIDEO_VIEWS_LAST30%TYPE;
    v_videoviews GLOBAL_YT_STATS.VIDEO_VIEWS%TYPE;
    v_subscribers GLOBAL_YT_STATS.SUBSCRIBERS%TYPE;
    v_subscribers30 GLOBAL_YT_STATS.SUBSCRIBERS_LAST30%TYPE;
    v_viewratio GLOBAL_YT_STATS.VIDEO_VIEWS%TYPE;
    v_subratio GLOBAL_YT_STATS.SUBSCRIBERS%TYPE;
    v_youtuber GLOBAL_YT_STATS.YOUTUBER_NAME%TYPE;

begin 

FOR channel IN (
        SELECT YOUTUBER_NAME, SUBSCRIBERS, VIDEO_VIEWS, SUBSCRIBERS_LAST30, VIDEO_VIEWS_LAST30 
        FROM GLOBAL_YT_STATS
    )
    LOOP
        v_subscribers := channel.SUBSCRIBERS; 
        v_subscribers30 := channel.SUBSCRIBERS_LAST30; 
        v_videoviews := channel.VIDEO_VIEWS; 
        v_views30 := channel.VIDEO_VIEWS_LAST30;
        v_youtuber := channel.YOUTUBER_NAME;

        IF v_subscribers > 10 THEN 
            v_viewratio := v_videoviews / v_views30;
            v_subratio := v_subscribers / v_subscribers30;
        END IF;

        v_viewratio := ROUND(v_viewratio, 1);
        v_subratio := ROUND(v_subratio, 1); 


        IF v_viewratio > 1000000 OR v_subratio > 1000000 THEN
            dbms_output.put_line('Channel: ' || v_youtuber || '     View Ratio: ' || v_viewratio || '         Sub Ratio:' || v_subratio );
        END IF;

    END LOOP;



END recent_legacy_success;


/*Query Results

Channel: Badabun     View Ratio: 44086467.5         Sub Ratio:624000
Channel: A4     View Ratio: 244006710.8         Sub Ratio:4630000
Channel: Bad Bunny     View Ratio: 30686342319         Sub Ratio:
Channel: BRIGHT SIDE     View Ratio:          Sub Ratio:44500000
Channel: Alan Walker     View Ratio: 585648399         Sub Ratio:
Channel: HolaSoyGerman.     View Ratio: 1207827811.3         Sub Ratio:
Channel: Toys and Colors     View Ratio: 9401010631.2         Sub Ratio:
Channel: LUCCAS NETO - LUCCAS TOON     View Ratio: 11151273541         Sub Ratio:
Channel: One Direction     View Ratio: 2142234.4         Sub Ratio:382000
Channel: MrBeast Gaming     View Ratio: 197854142.1         Sub Ratio:36100000
Channel: Total Gaming     View Ratio: 104837060.9         Sub Ratio:17700000
Channel: Techno Gamerz     View Ratio: 112680228.7         Sub Ratio:11466666.7
Channel: WowKidz     View Ratio: 16613441479         Sub Ratio:
Channel: YOLO AVENTURAS     View Ratio: 2695360.7         Sub Ratio:312000
Channel: Frost Diamond     View Ratio:          Sub Ratio:5016666.7
Channel: Masha y el Oso     View Ratio: 6788571363         Sub Ratio:
Channel: Drake     View Ratio: 494157907         Sub Ratio:28100000
Channel: Sandeep Maheshwari     View Ratio:          Sub Ratio:27800000
Channel: MrBeast 2     View Ratio: 7014762.9         Sub Ratio:
Channel: ToyPuddingTV     View Ratio: 1136920159.1         Sub Ratio:
Channel: Goldmines     View Ratio: 1339901698.9         Sub Ratio:
Channel: 5-Minute Crafts     View Ratio: 26236790209         Sub Ratio:
Channel: T-Series Bhakti Sagar     View Ratio: 2953323032.8         Sub Ratio:
Channel: LooLoo Kids - Nursery Rhymes and Children's Songs     View Ratio: 203222838         Sub Ratio:
Channel: Cardi B     View Ratio: 1090632884         Sub Ratio:
Channel: CKN     View Ratio: 120545462.4         Sub Ratio:18700000
Channel: Ali-A     View Ratio: 6148303268         Sub Ratio:
Channel: Dhar Mann     View Ratio:          Sub Ratio:9200000
Channel: Ajay Sharma     View Ratio:          Sub Ratio:18100000
Channel: And TV     View Ratio: 3853083251.3         Sub Ratio:
Channel: Zuni and Family     View Ratio: 1686567364.5         Sub Ratio:
Channel: Jason Vlogs     View Ratio: 356145899.2         Sub Ratio:
Channel: deepesh zo     View Ratio: 7206462713         Sub Ratio:16800000
Channel: Salman Noman     View Ratio: 1484719700.3         Sub Ratio:1670000
Channel: Alfredo Larin     View Ratio: 14431830557         Sub Ratio:
Channel: Marï¿½ï¿½ï¿½ï¿½ï¿½     View Ratio: 6199178137.3         Sub Ratio:8666666.7
Channel: Fede Vigevani     View Ratio:          Sub Ratio:12800000
Channel: ZHC     View Ratio: 136345854.4         Sub Ratio:6375000
Channel: ABPLIVE     View Ratio: 3984181690.5         Sub Ratio:
Channel: Goldmines Movies     View Ratio: 1884312866.3         Sub Ratio:
Channel: FaZe Rug     View Ratio:          Sub Ratio:23700000
Channel: Alan Becker     View Ratio:          Sub Ratio:22900000
Channel: Smile Family     View Ratio: 11787524         Sub Ratio:2230000
Channel: Disney Latinoamï¿½ï¿½     View Ratio: 4377531.6         Sub Ratio:
Channel: Rotana     View Ratio: 1828526.3         Sub Ratio:218000
Channel: Netflix India     View Ratio: 19070917.1         Sub Ratio:
Channel: SMOL     View Ratio: 7355194004.7         Sub Ratio:
Channel: invictor     View Ratio: 171625341.3         Sub Ratio:5375000
Channel: YOLO     View Ratio:          Sub Ratio:4280000
Channel: Zach King     View Ratio: 43281317.5         Sub Ratio:2070000
Channel: Deddy Corbuzier     View Ratio: 58306942.3         Sub Ratio:20600000
Channel: Linkin Park     View Ratio:          Sub Ratio:1700000
Channel: Marvel Entertainment     View Ratio: 89439608.3         Sub Ratio:670000
Channel: SCTV     View Ratio: 29192488.6         Sub Ratio:
Channel: AS Gaming     View Ratio: 123957583.9         Sub Ratio:
Channel: Masha e o Urso     View Ratio:          Sub Ratio:9450000
Channel: NOBRU     View Ratio: 175881662         Sub Ratio:14400000
Channel: SIS vs BRO     View Ratio: 66418405.3         Sub Ratio:1420000
Channel: The Dodo     View Ratio: 1382369.1         Sub Ratio:2840000
Channel: Trap City     View Ratio: 34894760.9         Sub Ratio:14100000
Channel: Jamuna TV     View Ratio: 12129583055         Sub Ratio:
Channel: Desi Gamers     View Ratio: 427039047.8         Sub Ratio:
Channel: JULIA GISELLA     View Ratio: 3331351.6         Sub Ratio:103846.2
Channel: The Q     View Ratio: 1435404171.7         Sub Ratio:13400000
Channel: Stray Kids     View Ratio: 1682115243.5         Sub Ratio:13300000
Channel: AdMe     View Ratio: 1122170225.8         Sub Ratio:
Channel: ExtraPolinesios     View Ratio: 9437504.9         Sub Ratio:16200000
Channel: FitDance     View Ratio: 9136167.6         Sub Ratio:4025000
Channel: Enes Batur     View Ratio:          Sub Ratio:1454545.5
Channel: ýýýýýýýýýý     View Ratio:          Sub Ratio:1590000
Channel: Mr DegrEE     View Ratio:          Sub Ratio:1550000
Channel: Musas     View Ratio: 27907413.5         Sub Ratio:
Channel: Republic Bharat     View Ratio: 7551195.5         Sub Ratio:
Channel: Bayashi TV     View Ratio: 3478247.4         Sub Ratio:1655555.6
Channel: Ryan Trahan     View Ratio: 8801014         Sub Ratio:13100000
Channel: Knowledge Tv ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½     View Ratio: 968291352         Sub Ratio:
Channel: DJ Khaled     View Ratio: 17514038.9         Sub Ratio:4366666.7
Channel: Jomy Production     View Ratio: 2528581628         Sub Ratio:
Channel: Wolfoo Channel     View Ratio: 511098         Sub Ratio:1625000
Channel: Ian Lucas     View Ratio: 30226553         Sub Ratio:1587500
Channel: Jass Records     View Ratio: 5958994201         Sub Ratio:
Channel: Troom Troom Indonesia     View Ratio: 5379684248         Sub Ratio:
Channel: ANNA KOVA     View Ratio: 6979793154         Sub Ratio:


PL/SQL procedure successfully completed.

*/




